function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}function e(e,r){if(e){if("string"==typeof e)return t(e,r);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,r)}}new/*#__PURE__*/(function(){var r;function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),this.tableSize=t,this.numberElements=[],this.handleMove=this.handleMove.bind(this),this.start=this.start.bind(this),this.initSelectors(),this.initListeners()}return r=[{key:"initSelectors",value:function(){this.tableEl=document.querySelector("table"),this.scoreEl=document.querySelector(".game-score"),this.messageLoseEl=document.querySelector(".message-lose"),this.messageWinEl=document.querySelector(".message-win"),this.messageStartEl=document.querySelector(".message-start"),this.startButtonEl=document.querySelector(".button")}},{key:"initListeners",value:function(){window.addEventListener("keyup",this.handleMove),this.startButtonEl.addEventListener("click",this.start)}},{key:"init",value:function(){for(var t=0;t<this.tableSize;t++){var e=document.createElement("tr");e.classList.add("field-row"),this.tableEl.append(e);for(var r=0;r<this.tableSize;r++){var i=document.createElement("td");i.classList.add("field-cell"),e.append(i)}}}},{key:"start",value:function(){var t=this;this.score=0,this.gameOver=!1,this.hasWon=!1,this.matrix=Array(this.tableSize).fill([]).map(function(){return Array(t.tableSize).fill(0)}),this.messageLoseEl.classList.add("hidden"),this.messageWinEl.classList.add("hidden"),this.startButtonEl.classList.contains("start")&&(this.startButtonEl.classList.remove("start"),this.startButtonEl.classList.add("restart"),this.startButtonEl.textContent="Restart",this.messageStartEl.classList.add("hidden")),this.addNumber(),this.addNumber(),this.render()}},{key:"getRandomNumber",value:function(){return Math.random()>=.9?4:2}},{key:"getRandomCell",value:function(){var t=this.getFreeCells();return t[Math.floor(Math.random()*t.length)]}},{key:"getFreeCells",value:function(){return this.matrix.reduce(function(t,e,r){return e.forEach(function(e,i){return 0===e&&t.push([r,i])}),t},[])}},{key:"addNumber",value:function(){var t,r=function(t){if(Array.isArray(t))return t}(t=this.getRandomCell())||function(t,e){var r,i,a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var n=[],s=!0,o=!1;try{for(a=a.call(t);!(s=(r=a.next()).done)&&(n.push(r.value),2!==n.length);s=!0);}catch(t){o=!0,i=t}finally{try{s||null==a.return||a.return()}finally{if(o)throw i}}return n}}(t,2)||e(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=r[0],a=r[1];this.matrix[i][a]=this.getRandomNumber(),this.render()}},{key:"canMove",value:function(){if(this.getFreeCells().length>0)return!0;for(var t=0;t<this.tableSize;t++)for(var e=0;e<this.tableSize;e++)if(this.matrix[t][e+1]&&this.matrix[t][e]===this.matrix[t][e+1]||this.matrix[t+1]&&this.matrix[t][e]===this.matrix[t+1][e])return!0;return!1}},{key:"matrixShift",value:function(){var t=this,e=Array(this.tableSize).fill(0);this.matrix=this.matrix.map(function(r){return r.filter(function(t){return t>0}).concat(e).slice(0,t.tableSize)})}},{key:"matrixRotate",value:function(r){var i=this;switch(r){case 90:case -270:this.matrix=this.matrix.map(function(t,e){return i.matrix.map(function(t){return t[e]}).reverse()});break;case 180:case -180:this.matrix=this.matrix.map(function(t){return t.reverse()}).reverse();break;case 270:case -90:this.matrix=this.matrix.map(function(r,a){return i.matrix.map(function(r){return((function(e){if(Array.isArray(e))return t(e)})(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||e(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).reverse()[a]})});break;case 0:case 360:case -360:return this.matrix;default:throw Error("Degree must be one of 90, -90, 180, -180, 270, -270")}}},{key:"handleMove",value:function(t){if(!this.gameOver)switch(t.key){case"ArrowLeft":this.merge(),this.render();break;case"ArrowDown":this.matrixRotate(90),this.merge(),this.matrixRotate(-90),this.render();break;case"ArrowRight":this.matrixRotate(180),this.merge(),this.matrixRotate(-180),this.render();break;case"ArrowUp":this.matrixRotate(270),this.merge(),this.matrixRotate(-270),this.render()}}},{key:"hasMatrixChanged",value:function(t){return this.matrix.some(function(e,r){return e.some(function(e,i){return e!==t[r][i]})})}},{key:"merge",value:function(){for(var t=this.matrix.map(function(t){return t.slice()}),e=0;e<this.tableSize;e++)for(var r=0;r<this.tableSize-1;r++)this.matrixShift(),this.matrix[e][r]===this.matrix[e][r+1]&&(this.matrix[e][r]*=2,this.matrix[e][r+1]=0,this.score+=this.matrix[e][r]);this.hasMatrixChanged(t)&&this.addNumber()}},{key:"render",value:function(){var t=this,e=this.tableEl.rows;this.numberElements.forEach(function(t){t.textContent="",t.className="field-cell"}),this.numberElements=[],this.matrix.forEach(function(r,i){r.forEach(function(r,a){if(r){var n=e[i].cells[a];n.textContent=r,n.classList.add("field-cell--".concat(r)),t.numberElements.push(n),t.scoreEl.textContent=t.score}})}),this.matrix.some(function(t){return t.some(function(t){return 2048===t})})&&!this.hasWon&&(this.messageWinEl.classList.remove("hidden"),this.hasWon=!0,setTimeout(function(){t.messageWinEl.classList.add("hidden")},8e3)),this.canMove()||(this.messageLoseEl.classList.remove("hidden"),this.gameOver=!0)}}],function(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(i.prototype,r),i}())().init();
//# sourceMappingURL=index.4732452a.js.map
